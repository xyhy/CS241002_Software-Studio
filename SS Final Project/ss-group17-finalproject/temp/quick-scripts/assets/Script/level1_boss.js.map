{"version":3,"sources":["level1_boss.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["import SceneManage from \"./scene_manage\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class level1_boss extends cc.Component {\n\n    @property(cc.Prefab)\n    ball: cc.Prefab = null;\n\n    @property(cc.Node)\n    summon_effect: cc.Node = null;\n\n    @property(cc.Node)\n    thunder: cc.Node = null;\n\n    @property({type:cc.AudioClip})\n    thunder_sound: cc.AudioClip = null;\n\n    @property({type:cc.AudioClip})\n    hurt_sound: cc.AudioClip = null;\n    public anim = null;\n\n    //public attack_anim = null;\n\n    private state;\n\n    private attack = false;\n\n    private life = 3;\n\n    private dead = false;\n\n    private win = false;\n\n    //public summon = null;\n\n    start () {\n        this.set_attack();\n        //this.scheduleOnce(()=>{this.get_thunder();}, 2);\n    }\n\n    set_attack(){\n        this.anim = this.getComponent(cc.Animation);\n        this.anim.on('finished', this.set_anim, this);\n        this.attack = true;\n        this.anim.play('attack');\n        this.get_thunder();\n        this.summon_effect.getComponent(cc.Animation).play('summon');\n        \n        this.schedule(()=>{\n            if(!this.anim.getAnimationState('attack').isPlaying && !this.dead)\n            {\n                this.anim.play('attack');\n                this.attack = true;\n                this.get_thunder();\n                this.summon_effect.getComponent(cc.Animation).play('summon');\n            }\n        } ,15);\n    }\n    set_anim(){\n        if(this.attack){\n            this.gen_lavaball();\n            this.attack = false;\n        }\n        if(!this.anim.getAnimationState('idle').isPlaying && !this.dead)\n            this.anim.play('idle');\n        \n    }\n    get_thunder(){\n        var act1 = cc.fadeOut(0.2);\n        var act2 = cc.callFunc(()=>{this.thunder.opacity = 255;});\n        var act3 = cc.fadeOut(1);\n        cc.audioEngine.playEffect(this.thunder_sound, false);\n        this.thunder.opacity = 255;\n        this.thunder.runAction(cc.sequence(act1, act2, act3));\n    }\n\n    gen_lavaball(){\n        for(var i=0; i<10; i++){\n            var new_ball = cc.instantiate(this.ball);\n            new_ball.parent = cc.find('All Nodes/Canvas').parent;\n        }\n    }\n\n    update (dt) {\n        this.summon_effect.position = this.node.position;\n    }\n    onBeginContact(contact, self, other){\n        if(other.node.name == 'player'){\n            contact.disabled = true;\n        }else if(other.node.name == 'bullet'){\n            cc.log('boss hit');\n            //this.anim.play('damage');\n            cc.audioEngine.playEffect(this.hurt_sound, false);\n            if(this.life > 1){\n                this.life--;\n                this.anim.play('damage');\n            }else{\n                if(!this.dead && !this.win){\n                    this.anim.play('dead_b1');\n                    this.dead = true;\n                    this.scheduleOnce(()=>{\n                        cc.find(\"SceneManager\").getComponent(\"scene_manage\").go_animation(\"animation1\");\n                    }, 2);\n                }\n            }\n        }\n    }\n}\n"]}