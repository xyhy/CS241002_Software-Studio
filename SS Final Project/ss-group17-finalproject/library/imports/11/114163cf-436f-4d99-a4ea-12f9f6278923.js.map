{"version":3,"sources":["../../../../assets/Script/assets/Script/level3_boss.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class level3_boss extends cc.Component {\n\n    // LIFE-CYCLE CALLBACKS:\n\n    @property(cc.Node)\n    player: cc.Node = null;\n\n    @property({type:cc.AudioClip})\n    hurt_sound: cc.AudioClip = null;\n\n    @property({type:cc.AudioClip})\n    attack1_sound: cc.AudioClip = null;\n    @property({type:cc.AudioClip})\n    attack2_sound: cc.AudioClip = null;\n    @property({type:cc.AudioClip})\n    block_sound: cc.AudioClip = null;\n\n    private scale_check = true;\n\n    private life = 5;\n\n    private anim;\n\n    private registered = false;\n\n    private detect_cooldown = false;\n\n    private registered_2 = false;\n\n    private registered_3 = false;\n\n    private state = -1;\n\n    private attack_set = ['attack_b3', 'attack2_b3'];\n\n    private check_win = false;\n\n    //-1: start\n    //0: stop\n    //1: run\n    //2: attack\n    //3: defence\n    //4: hurt\n    //5: win\n    //6: lose\n\n\n    onLoad () {\n        cc.director.getPhysicsManager().enabled = true;\n    }\n\n\n    start () {\n        this.anim = this.getComponent(cc.Animation);\n        this.anim.on('finished', this.return_idle, this);\n        this.anim.play('start_b3');\n        this.schedule(()=>{\n            if(this.state == 0){\n                this.check_scale();\n            }\n        }, 0.5);\n        this.schedule(()=>{\n            if(this.state == 0){\n                this.run_to_player();\n            }\n        }, 4);\n        this.schedule(()=>{\n            if(this.state!=5 && this.state!=6)\n                this.check_bullet();\n        },0.2);\n    }\n    check_bullet(){\n        this.player.parent.children.forEach((child)=>{\n            if(child.name == 'bullet'){\n                if(Math.abs(child.position.x - this.node.position.x) <= 150\n                && ((child.position.x - this.node.position.x >=0\n                && child.scaleX < 0) || (child.position.x - this.node.position.x < 0 && child.scaleX > 0))\n                && Math.abs(child.position.y - this.node.position.y) <= 50 \n                ){\n                    var block_or_not = this.random_num(11);\n                    //cc.log(block_or_not+'out');\n                    if(block_or_not <= 8 && !this.detect_cooldown){\n                        //cc.log(block_or_not);\n                        this.detect_cooldown = true;\n                        this.state = 3;\n                        this.block();\n                        this.scheduleOnce(()=>{\n                            this.detect_cooldown = false;\n                            //cc.log('set_back');\n                        }, 1);\n                    }\n                }\n            }\n        });\n    }\n    block(){\n        var s = this.anim.play('block_b3');\n        cc.audioEngine.playEffect(this.block_sound, false);\n        this.node.stopAllActions();\n\n    }\n    random_num(x){\n        return Math.floor(Math.random() * x);\n    }\n    check_scale(){\n        var now = this.player.position.x - this.node.position.x >= 0;\n        if(this.scale_check != now && now == true){\n            this.scale_check = now;\n            this.node.scaleX = 2.5;\n            this.node.position = cc.v2(this.node.position.x+35, this.node.position.y);\n        }else if(this.scale_check != now && now == false){\n            this.scale_check = now;\n            this.node.scaleX = -2.5;\n            this.node.position = cc.v2(this.node.position.x-35, this.node.position.y);\n        }\n    }\n    run_to_player(){\n        this.state = 1;\n        var player_pos_x;\n        this.check_scale();\n        if(this.scale_check){\n            player_pos_x = this.player.position.x - 50;\n        }else{\n            player_pos_x = this.player.position.x + 40;\n        }\n        var duration = Math.abs(this.node.position.x - player_pos_x)/200;\n        this.anim.play('run_b3');\n        var act1 = cc.moveTo(duration, cc.v2(player_pos_x, this.node.position.y));\n        var act2 = cc.callFunc(()=>{\n            if(Math.abs(this.player.position.x - player_pos_x) <= 60){\n                this.boss_attack();\n            }else{\n                this.return_idle();\n            }\n        });\n        this.node.runAction(cc.sequence(act1, act2));\n    }\n    return_idle(){\n        if(this.state != 5 && this.state != 6){\n            \n            //this.anim.play('idle_b3');\n            //this.state = 0;\n            if(this.state == 3){\n                this.run_to_player();\n            }else{\n                this.anim.play('idle_b3');\n                this.state = 0;\n            }\n        }\n    }\n    detect_player(){\n        var dis = Math.abs(this.player.position.x - this.node.position.x);\n        if(dis <= 70 && this.state == 0){\n            this.boss_attack();\n        }\n    }\n    boss_attack(){\n        this.state = 2;\n        var num = this.random_num(2);\n        this.anim.play(this.attack_set[num]);\n        if(num == 0){\n            this.scheduleOnce(()=>{\n                this.check_win = true;\n                cc.audioEngine.playEffect(this.attack1_sound, false);\n            }, 0.32);\n            this.scheduleOnce(()=>{\n                this.check_win = false;\n            }, 0.44);\n            this.scheduleOnce(()=>{\n                this.check_win = true;\n                cc.audioEngine.playEffect(this.attack1_sound, false);\n            }, 0.62);\n            this.scheduleOnce(()=>{\n                this.check_win = false;\n            }, 0.7);\n        }else if(num == 1){\n            this.scheduleOnce(()=>{\n                this.check_win = true;\n                cc.audioEngine.playEffect(this.attack2_sound, false);\n            }, 0.55);\n            this.scheduleOnce(()=>{\n                this.check_win = false;\n            }, 0.69);\n        }\n    }\n    update (dt) {\n        if(this.state!=5 && this.state!=6){\n            this.detect_player();\n            if(this.check_win){\n                this.check_player_killed();\n            }\n        }\n    }\n    \n    onBeginContact(contact, self, other){\n        if(other.node.name == 'player_boss'){\n            contact.disabled = true;\n        }else if(other.node.name == 'bullet'){\n            if(this.state != 3 && this.state != 5 && this.state != 6){\n                //this.state = 4;\n                //this.anim.pause();\n                cc.audioEngine.playEffect(this.hurt_sound, false);\n                if(this.life > 1){\n                    this.state = 4;\n                    this.anim.play('hurt_b3');\n                    this.life--;\n                }else{\n                    cc.log('lose');\n                    this.state = 6;\n                    this.anim.play('lose_b3');\n                    this.node.stopAllActions();\n                    this.scheduleOnce(()=>{\n                        cc.find(\"SceneManager\").getComponent(\"scene_manage\").go_animation(\"animation4\");\n                    }, 2);\n                }\n            }\n        }\n    }\n    check_player_killed(){\n        if(this.player.position.x - this.node.position.x >= 0\n            && this.player.position.x - this.node.position.x <= 80\n            && this.node.scaleX > 0\n            && Math.abs(this.player.position.y - this.node.position.y) <= 60){\n                this.state = 5;\n                this.anim.play('win_b3');\n                this.player.getComponent('player_boss').dead = true;\n            }\n        if(this.player.position.x - this.node.position.x <= 0\n            && this.player.position.x - this.node.position.x >= -80\n            && this.node.scaleX < 0\n            && Math.abs(this.player.position.y - this.node.position.y) <= 60){\n                this.state = 5;\n                this.anim.play('win_b3');\n                this.player.getComponent('player_boss').dead = true;\n            }    \n            \n    }\n    onPreSolve(contact, self, other){\n        if(other.node.name == 'player_boss')\n            contact.disabled = true;\n    }\n}\n"]}